# sqllab1 Вариант 5 Тюлин И.В. Костин А.О.

№1 и №2
```sql
insert into "СОТРУДНИК" ("ИДЕНТИФИКАТОР", "ФАМИЛИЯ", "АДРЕС", "НАЛОГ,%")
values (001, 'Пивоваров', 'Канавинский', 10),
       (002, 'Махалина', 'Сормовский', 10),
       (003, 'Щанников', 'Нижегородский', 15),
       (004, 'Воробьев', 'Советский', 15),
       (005, 'Алексанов', 'Советский', 10);

insert into "МЕСТО РАБОТЫ" ("ИДЕНТИФИКАТОР", "НАЗВАНИЕ ОРГ.", "АДРЕС", "ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД, %")
values (001, 'Университет', 'Приокский', 20),
       (002, 'Институт механики', 'Приокский', 10),
       (003, 'Технический Унивреситет', 'Нижегородский', 20),
       (004, 'НИИ ПМК', 'Нижегородский', 10),
       (005, 'Сельхоз. академия', 'Приокский', 20),
       (006, 'Академия бизнеса', 'Сормовский', 25);

insert into "ДОЛЖНОСТЬ" ("ИДЕНТИФИКАТОР", "НАЗВАНИЕ", "ПОЧАСОВАЯ ОПЛАТА, РУБ", "МАКС. ЧИСЛО ЧАСОВ")
values (001, 'Ассистент', 10000, 40),
       (002, 'Старший преподаватель', 15000, 35),
       (003, 'Доцент', 20000, 20),
       (004, 'Профессор', 25000, 10),
       (005, 'Мл. научный сотрудник', 7000, 60),
       (006, 'Ст. научный сотрудник', 10000, 50),
       (007, 'Зав. лабораторией', 13000, 40);

insert into "РАБОТА" ("НОМЕР", "ДАТА", "СОТРУДНИК", "МЕСТО РАБОТЫ", "ДОЛЖНОСТЬ", "КОЛ-ВО ЧАСОВ", "ПЛАТАРУБ")
values (20000, 'Январь', 003, 004, 007, 10, 130000),
       (20001, 'Январь', 005, 006, 004, 5, 125000),
       (20002, 'Февраль', 001, 006, 001, 35, 350000),
       (20003, 'Февраль', 002, 002, 005, 10, 70000),
       (20004, 'Февраль', 002, 001, 002, 30, 450000),
       (20005, 'Февраль', 002, 005, 001, 10, 100000),
       (20006, 'Февраль', 003, 002, 003, 15, 300000),
       (20007, 'Апрель', 001, 001, 002, 20, 300000),
       (20008, 'Апрель', 002, 005, 006, 40, 400000),
       (20009, 'Апрель', 004, 005, 001, 10, 100000),
       (20010, 'Май', 002, 002, 002, 20, 300000),
       (20011, 'Июнь', 003, 006, 003, 11, 220000),
       (20012, 'Июль', 001, 003, 002, 10, 150000),
       (20013, 'Июль', 002, 002, 003, 15, 300000),
       (20014, 'Август', 004, 002, 004, 8, 200000),
       (20015, 'Август', 005, 002, 007, 10, 130000),
       (20016, 'Август', 001, 003, 002, 20, 300000);
```
№3
```sql
select*
from "ДОЛЖНОСТЬ";

select*
from "МЕСТО РАБОТЫ";

select distinct *
from "СОТРУДНИК"
order by "ИДЕНТИФИКАТОР";

select*
from "РАБОТА";
```

| ИДЕНТИФИКАТОР | НАЗВАНИЕ | ПОЧАСОВАЯ ОПЛАТА, РУБ | МАКС. ЧИСЛО ЧАСОВ |
| :--- | :--- | :--- | :--- |
| 1 | Ассистент | 10000 | 40 |
| 2 | Старший преподаватель | 15000 | 35 |
| 3 | Доцент | 20000 | 20 |
| 4 | Профессор | 25000 | 10 |
| 5 | Мл. научный сотрудник | 7000 | 60 |
| 6 | Ст. научный сотрудник | 10000 | 50 |
| 7 | Зав. лабораторией | 13000 | 40 |

| ИДЕНТИФИКАТОР | НАЗВАНИЕ ОРГ. | АДРЕС | ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД, % |
| :--- | :--- | :--- | :--- |
| 1 | Университет | Приокский | 20 |
| 2 | Институт механики | Приокский | 10 |
| 3 | Технический Унивреситет | Нижегородский | 20 |
| 4 | НИИ ПМК | Нижегородский | 10 |
| 5 | Сельхоз. академия | Приокский | 20 |
| 6 | Академия бизнеса | Сормовский | 25 |

| ИДЕНТИФИКАТОР | ФАМИЛИЯ | АДРЕС | НАЛОГ,% |
| :--- | :--- | :--- | :--- |
| 1 | Пивоваров | Канавинский | 10 |
| 2 | Махалина | Сормовский | 10 |
| 3 | Щанников | Нижегородский | 15 |
| 4 | Воробьев | Советский | 15 |
| 5 | Алексанов | Советский | 10 |


| НОМЕР | ДАТА | СОТРУДНИК | МЕСТО РАБОТЫ | ДОЛЖНОСТЬ | КОЛ-ВО ЧАСОВ | ПЛАТАРУБ |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 20000 | Январь | 3 | 4 | 7 | 10 | 130000 |
| 20001 | Январь | 5 | 6 | 4 | 5 | 125000 |
| 20002 | Февраль | 1 | 6 | 1 | 35 | 350000 |
| 20003 | Февраль | 2 | 2 | 5 | 10 | 70000 |
| 20004 | Февраль | 2 | 1 | 2 | 30 | 450000 |
| 20005 | Февраль | 2 | 5 | 1 | 10 | 100000 |
| 20006 | Февраль | 3 | 2 | 3 | 15 | 300000 |
| 20007 | Апрель | 1 | 1 | 2 | 20 | 300000 |
| 20008 | Апрель | 2 | 5 | 6 | 40 | 400000 |
| 20009 | Апрель | 4 | 5 | 1 | 10 | 100000 |
| 20010 | Май | 2 | 2 | 2 | 20 | 300000 |
| 20011 | Июнь | 3 | 6 | 3 | 11 | 220000 |
| 20012 | Июль | 1 | 3 | 2 | 10 | 150000 |
| 20013 | Июль | 2 | 2 | 3 | 15 | 300000 |
| 20014 | Август | 4 | 2 | 4 | 8 | 200000 |
| 20015 | Август | 5 | 2 | 7 | 10 | 130000 |
| 20016 | Август | 1 | 3 | 2 | 20 | 300000 |



№4 Создать запросы для вывода:

a) всех различных размеров налогов;
```sql
select distinct "НАЛОГ,%"
from "СОТРУДНИК";
```
| НАЛОГ,% |
| :--- |
| 15 |
| 10 |

b) всех различных мест работы;
```sql
select distinct "НАЗВАНИЕ ОРГ."
from "МЕСТО РАБОТЫ";
```
| НАЗВАНИЕ ОРГ. |
| :--- |
| Сельхоз. академия |
| Институт механики |
| Академия бизнеса |
| Технический Унивреситет |
| Университет |
| НИИ ПМК |

c) всех различных районов проживания сотрудников.
```sql
select distinct "АДРЕС"
from "СОТРУДНИК";
```
| АДРЕС |
| :--- |
| Канавинский |
| Нижегородский |
| Сормовский |
| Советский |

№5 Создав запрос получить следующую информацию:

a) фамилии и адреса сотрудников, имеющих налог более 8%;
```sql
select distinct "ФАМИЛИЯ", "АДРЕС"
from "СОТРУДНИК"
where "НАЛОГ,%" > 8;
```
| ФАМИЛИЯ | АДРЕС |
| :--- | :--- |
| Алексанов | Советский |
| Воробьев | Советский |
| Щанников | Нижегородский |
| Пивоваров | Канавинский |
| Махалина | Сормовский |

b) почасовую оплату и название для должностей, в названии которых встречаются слова “научный сотрудник”;
```sql
select "НАЗВАНИЕ","ПОЧАСОВАЯ ОПЛАТА, РУБ"
from "ДОЛЖНОСТЬ"
where "НАЗВАНИЕ" LIKE '%научный сотрудник%';
```
| НАЗВАНИЕ | ПОЧАСОВАЯ ОПЛАТА, РУБ |
| :--- | :--- |
| Мл. научный сотрудник | 7000 |
| Ст. научный сотрудник | 10000 |

c) номер, дату и количество часов для тех записей о работе, где плата превышала 100000руб.
```sql
select "НОМЕР", "ДАТА", "КОЛ-ВО ЧАСОВ"
from "РАБОТА"
where "ПЛАТАРУБ" > 100000;
```
| НОМЕР | ДАТА | КОЛ-ВО ЧАСОВ |
| :--- | :--- | :--- |
| 20000 | Январь | 10 |
| 20001 | Январь | 5 |
| 20002 | Февраль | 35 |
| 20004 | Февраль | 30 |
| 20006 | Февраль | 15 |
| 20007 | Апрель | 20 |
| 20008 | Апрель | 40 |
| 20010 | Май | 20 |
| 20011 | Июнь | 11 |
| 20012 | Июль | 10 |
| 20013 | Июль | 15 |
| 20014 | Август | 8 |
| 20015 | Август | 10 |
| 20016 | Август | 20 |

№6 На основании данных о работе вывести все данные в таком формате:

a) номер, фамилия сотрудника, дата, количество часов. Отсортировать по количеству часов;
```sql
select distinct "НОМЕР", "ФАМИЛИЯ", "ДАТА", "КОЛ-ВО ЧАСОВ"
from "РАБОТА", "СОТРУДНИК"
where "РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР"
order by "КОЛ-ВО ЧАСОВ";
```
| НОМЕР | ФАМИЛИЯ | ДАТА | КОЛ-ВО ЧАСОВ |
| :--- | :--- | :--- | :--- |
| 20001 | Алексанов | Январь | 5 |
| 20014 | Воробьев | Август | 8 |
| 20000 | Щанников | Январь | 10 |
| 20003 | Махалина | Февраль | 10 |
| 20005 | Махалина | Февраль | 10 |
| 20009 | Воробьев | Апрель | 10 |
| 20012 | Пивоваров | Июль | 10 |
| 20015 | Алексанов | Август | 10 |
| 20011 | Щанников | Июнь | 11 |
| 20006 | Щанников | Февраль | 15 |
| 20013 | Махалина | Июль | 15 |
| 20007 | Пивоваров | Апрель | 20 |
| 20010 | Махалина | Май | 20 |
| 20016 | Пивоваров | Август | 20 |
| 20004 | Махалина | Февраль | 30 |
| 20002 | Пивоваров | Февраль | 35 |
| 20008 | Махалина | Апрель | 40 |

b) название работы, должность, дата, плата.
```sql
select "НАЗВАНИЕ ОРГ.", "НАЗВАНИЕ", "ДАТА", "ПЛАТАРУБ"
from "РАБОТА", "ДОЛЖНОСТЬ", "МЕСТО РАБОТЫ"
where "РАБОТА"."МЕСТО РАБОТЫ" = "МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР"
  and "РАБОТА"."ДОЛЖНОСТЬ" = "ДОЛЖНОСТЬ"."ИДЕНТИФИКАТОР";
```
| НАЗВАНИЕ ОРГ. | НАЗВАНИЕ | ДАТА | ПЛАТАРУБ |
| :--- | :--- | :--- | :--- |
| НИИ ПМК | Зав. лабораторией | Январь | 130000 |
| Академия бизнеса | Профессор | Январь | 125000 |
| Академия бизнеса | Ассистент | Февраль | 350000 |
| Институт механики | Мл. научный сотрудник | Февраль | 70000 |
| Университет | Старший преподаватель | Февраль | 450000 |
| Сельхоз. академия | Ассистент | Февраль | 100000 |
| Институт механики | Доцент | Февраль | 300000 |
| Университет | Старший преподаватель | Апрель | 300000 |
| Сельхоз. академия | Ст. Научный сотрудник | Апрель | 400000 |
| Сельхоз. академия | Ассистент | Апрель | 100000 |
| Институт механики | Старший преподаватель | Май | 300000 |
| Академия бизнеса | Доцент | Июнь | 220000 |
| Технический Унивреситет | Старший преподаватель | Июль | 150000 |
| Институт механики | Доцент | Июль | 300000 |
| Институт механики | Профессор | Август | 200000 |
| Институт механики | Зав. лабораторией | Август | 130000 |
| Технический Унивреситет | Старший преподаватель | Август | 300000 |

№7 Вывести:

a) названия организаций, где работали доценты или служащие того же района;
```sql
select distinct "НАЗВАНИЕ ОРГ."
from "РАБОТА", "МЕСТО РАБОТЫ", "СОТРУДНИК", "ДОЛЖНОСТЬ"
where (("РАБОТА"."ДОЛЖНОСТЬ" = "ДОЛЖНОСТЬ"."ИДЕНТИФИКАТОР" and
       "ДОЛЖНОСТЬ"."НАЗВАНИЕ" = 'Доцент') or
      ("РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР" and "СОТРУДНИК"."АДРЕС" = "МЕСТО РАБОТЫ"."АДРЕС")) and
      "РАБОТА"."МЕСТО РАБОТЫ" = "МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР";
```
| НАЗВАНИЕ ОРГ. |
| :--- |
| Академия бизнеса |
| Институт механики |
| НИИ ПМК |

b) фамилии и размер налога для тех работников, которые имели работу с почасовой оплатой менее 15000руб. не ранее января;
```sql
select distinct "ФАМИЛИЯ", "НАЛОГ,%"
from "СОТРУДНИК", "РАБОТА", "ДОЛЖНОСТЬ"
where ("ДАТА" != 'Январь') and ("РАБОТА"."ДОЛЖНОСТЬ" = "ДОЛЖНОСТЬ"."ИДЕНТИФИКАТОР"
                                    and "ДОЛЖНОСТЬ"."ПОЧАСОВАЯ ОПЛАТА, РУБ" < 15000)
  and "РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР"
```
| ФАМИЛИЯ | НАЛОГ,% |
| :--- | :--- |
| Махалина | 10 |
| Воробьев | 15 |
| Алексанов | 10 |
| Пивоваров | 10 |

c) название и размер отчислений для организаций, где работал Александров более одного раза.
```sql
select "НАЗВАНИЕ ОРГ.", "ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД, %"
from "МЕСТО РАБОТЫ"
where "ИДЕНТИФИКАТОР" in (select "МЕСТО РАБОТЫ"
                         from "РАБОТА"
                         where "СОТРУДНИК" = 5
                         group by "МЕСТО РАБОТЫ"
                         having count(*) > 1
)
```
| НАЗВАНИЕ ОРГ. | ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД, % |
| :--- | :--- |


d) номер работы, название организации, где работали работники из Советского района. Добавить в вывод фамилии таких работников и отсортировать по названию организации.
```sql
select distinct "НОМЕР", "НАЗВАНИЕ ОРГ.", "ФАМИЛИЯ"
from "РАБОТА","МЕСТО РАБОТЫ", "СОТРУДНИК"
where ("РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР"
           and "СОТРУДНИК"."АДРЕС" = 'Советский')
  and ("РАБОТА"."МЕСТО РАБОТЫ" = "МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР")
order by "НАЗВАНИЕ ОРГ.";
```
| НОМЕР | НАЗВАНИЕ ОРГ. | ФАМИЛИЯ |
| :--- | :--- | :--- |
| 20001 | Академия бизнеса | Алексанов |
| 20014 | Институт механики | Воробьев |
| 20015 | Институт механики | Алексанов |
| 20009 | Сельхоз. академия | Воробьев |

№8 Создать запрос для модификации всех значений столбца с суммарной величиной платы, чтобы он содержал истинную сумму, полученную работником ( за вычетом налога). Вывести новые значения.
```sql
update "РАБОТА"
set "ПЛАТАРУБ" = "ПЛАТАРУБ" - "ПЛАТАРУБ" / 100 * (select distinct "НАЛОГ,%"
                                                  from "СОТРУДНИК"
                                                  where "РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР");
select*
from "РАБОТА";
```
| НОМЕР | ДАТА | СОТРУДНИК | МЕСТО РАБОТЫ | ДОЛЖНОСТЬ | КОЛ-ВО ЧАСОВ | ПЛАТАРУБ |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 20000 | Январь | 3 | 4 | 7 | 10 | 110500 |
| 20001 | Январь | 5 | 6 | 4 | 5 | 112500 |
| 20002 | Февраль | 1 | 6 | 1 | 35 | 315000 |
| 20003 | Февраль | 2 | 2 | 5 | 10 | 63000 |
| 20004 | Февраль | 2 | 1 | 2 | 30 | 405000 |
| 20005 | Февраль | 2 | 5 | 1 | 10 | 90000 |
| 20006 | Февраль | 3 | 2 | 3 | 15 | 255000 |
| 20007 | Апрель | 1 | 1 | 2 | 20 | 270000 |
| 20008 | Апрель | 2 | 5 | 6 | 40 | 360000 |
| 20009 | Апрель | 4 | 5 | 1 | 10 | 85000 |
| 20010 | Май | 2 | 2 | 2 | 20 | 270000 |
| 20011 | Июнь | 3 | 6 | 3 | 11 | 187000 |
| 20012 | Июль | 1 | 3 | 2 | 10 | 135000 |
| 20013 | Июль | 2 | 2 | 3 | 15 | 270000 |
| 20014 | Август | 4 | 2 | 4 | 8 | 170000 |
| 20015 | Август | 5 | 2 | 7 | 10 | 117000 |
| 20016 | Август | 1 | 3 | 2 | 20 | 270000 |

№9 Расширить таблицу с данными о работах столбцом, содержащим величину отчислений в пенсионный фонд. Создать запрос для ввода конкретных значений во все строки таблицы
```sql
alter table "РАБОТА"
    add column "ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД" integer check ("ПЛАТАРУБ" >= 0) not null default 0;
update "РАБОТА"
set "ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД" = "ПЛАТАРУБ" / 100 * (select distinct "ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД, %"
                                                            from "МЕСТО РАБОТЫ"
                                                            where "РАБОТА"."МЕСТО РАБОТЫ" = "МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР");
select*
from "РАБОТА";
```
| НОМЕР | ДАТА | СОТРУДНИК | МЕСТО РАБОТЫ | ДОЛЖНОСТЬ | КОЛ-ВО ЧАСОВ | ПЛАТАРУБ | ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 20000 | Январь | 3 | 4 | 7 | 10 | 110500 | 11050 |
| 20001 | Январь | 5 | 6 | 4 | 5 | 112500 | 28125 |
| 20002 | Февраль | 1 | 6 | 1 | 35 | 315000 | 78750 |
| 20003 | Февраль | 2 | 2 | 5 | 10 | 63000 | 6300 |
| 20004 | Февраль | 2 | 1 | 2 | 30 | 405000 | 81000 |
| 20005 | Февраль | 2 | 5 | 1 | 10 | 90000 | 18000 |
| 20006 | Февраль | 3 | 2 | 3 | 15 | 255000 | 25500 |
| 20007 | Апрель | 1 | 1 | 2 | 20 | 270000 | 54000 |
| 20008 | Апрель | 2 | 5 | 6 | 40 | 360000 | 72000 |
| 20009 | Апрель | 4 | 5 | 1 | 10 | 85000 | 17000 |
| 20010 | Май | 2 | 2 | 2 | 20 | 270000 | 27000 |
| 20011 | Июнь | 3 | 6 | 3 | 11 | 187000 | 46750 |
| 20012 | Июль | 1 | 3 | 2 | 10 | 135000 | 27000 |
| 20013 | Июль | 2 | 2 | 3 | 15 | 270000 | 27000 |
| 20014 | Август | 4 | 2 | 4 | 8 | 170000 | 17000 |
| 20015 | Август | 5 | 2 | 7 | 10 | 117000 | 11700 |
| 20016 | Август | 1 | 3 | 2 | 20 | 270000 | 54000 |


№10 Используя операцию IN (NOT IN) реализовать следующие запросы:

a) найти такие места работы, где не трудились сотрудники из Приокского района;
```sql
select distinct "НАЗВАНИЕ ОРГ."
from "РАБОТА", "МЕСТО РАБОТЫ", "СОТРУДНИК"
where ("РАБОТА"."МЕСТО РАБОТЫ" = "МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР")
  and ("РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР"
           and "СОТРУДНИК"."АДРЕС" not in('Приокский'));
```
| НАЗВАНИЕ ОРГ. |
| :--- |
| Сельхоз. академия |
| Институт механики |
| Академия бизнеса |
| Технический Унивреситет |
| Университет |
| НИИ ПМК |

b) запросы задания 7.а и 7.d;

7.а
```sql
select distinct "НАЗВАНИЕ ОРГ."
from "РАБОТА", "МЕСТО РАБОТЫ", "СОТРУДНИК", "ДОЛЖНОСТЬ"
where (("РАБОТА"."ДОЛЖНОСТЬ" in ("ДОЛЖНОСТЬ"."ИДЕНТИФИКАТОР") and
       "ДОЛЖНОСТЬ"."НАЗВАНИЕ" in ('Доцент')) or
      ("РАБОТА"."СОТРУДНИК" in ("СОТРУДНИК"."ИДЕНТИФИКАТОР")
           and "СОТРУДНИК"."АДРЕС" in ("МЕСТО РАБОТЫ"."АДРЕС"))) and
      "РАБОТА"."МЕСТО РАБОТЫ" in ("МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР");
```
| НАЗВАНИЕ ОРГ. |
| :--- |
| Академия бизнеса |
| Институт механики |
| НИИ ПМК |

7.d
```sql
select distinct "НОМЕР", "НАЗВАНИЕ ОРГ.", "ФАМИЛИЯ"
from "РАБОТА","МЕСТО РАБОТЫ", "СОТРУДНИК"
where ("РАБОТА"."СОТРУДНИК" in ("СОТРУДНИК"."ИДЕНТИФИКАТОР")
           and "СОТРУДНИК"."АДРЕС" in ('Советский'))
  and ("РАБОТА"."МЕСТО РАБОТЫ" in ("МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР"))
order by "НАЗВАНИЕ ОРГ.";
```
| НОМЕР | НАЗВАНИЕ ОРГ. | ФАМИЛИЯ |
| :--- | :--- | :--- |
| 20001 | Академия бизнеса | Алексанов |
| 20014 | Институт механики | Воробьев |
| 20015 | Институт механики | Алексанов |
| 20009 | Сельхоз. академия | Воробьев |

c) определить должности, на которых работал Пивоваров более раза.
```sql
select "НАЗВАНИЕ"
from "ДОЛЖНОСТЬ"
where "ИДЕНТИФИКАТОР" in (select "ДОЛЖНОСТЬ"
                          from "РАБОТА"
                          where "СОТРУДНИК" = 1
                          group by "ДОЛЖНОСТЬ"
                          having count(*) > 1);
```
| НАЗВАНИЕ |
| :--- |
| Старший преподаватель |


№11 Используя операции ALL-ANY реализовать следующие запросы:

a) найти должность с самой высокой почасовой оплатой;
```sql
select "НАЗВАНИЕ"
from "ДОЛЖНОСТЬ"
where "ПОЧАСОВАЯ ОПЛАТА, РУБ" >= all(
    select "ПОЧАСОВАЯ ОПЛАТА, РУБ"
    from "ДОЛЖНОСТЬ");
```
| НАЗВАНИЕ |
| :--- |
| Профессор |

b) найти место работы, где на самой низкооплачиваемой должности работал Воробьев;
```sql
select distinct "НАЗВАНИЕ ОРГ."
from "МЕСТО РАБОТЫ", "РАБОТА", "ДОЛЖНОСТЬ", "СОТРУДНИК"
where ("РАБОТА"."МЕСТО РАБОТЫ" in ("МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР"))
  and ("РАБОТА"."СОТРУДНИК" in ("СОТРУДНИК"."ИДЕНТИФИКАТОР")
           and ("СОТРУДНИК"."ФАМИЛИЯ" in ('Воробьев')))
  and ("РАБОТА"."ДОЛЖНОСТЬ" = "ДОЛЖНОСТЬ"."ИДЕНТИФИКАТОР")
  and ("ПОЧАСОВАЯ ОПЛАТА, РУБ" < any(
      select "ПОЧАСОВАЯ ОПЛАТА, РУБ"
      from "ДОЛЖНОСТЬ"
    ));
```
| НАЗВАНИЕ ОРГ. |
| :--- |
| Сельхоз. академия |

c) среди работавших в университете найти сотрудника с самым низким налогом;

1) Если налог расчитывается в рублях
```sql
select distinct "ФАМИЛИЯ"
from "СОТРУДНИК",
     "РАБОТА"
where ("РАБОТА"."МЕСТО РАБОТЫ" = 1)
  and ("РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР")
  and ("СОТРУДНИК"."НАЛОГ,%" < any (select "НАЛОГ,%"
                                    from "СОТРУДНИК"))
  and "РАБОТА"."ПЛАТАРУБ" < any (select "ПЛАТАРУБ"
                                 from "РАБОТА");
```
| ФАМИЛИЯ |
| :--- |
| Пивоваров |

2) Если налог расчитывается в процентах
```sql
select distinct "ФАМИЛИЯ"
from "СОТРУДНИК",
     "РАБОТА"
where ("РАБОТА"."МЕСТО РАБОТЫ" = 1)
  and ("РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР")
  and ("СОТРУДНИК"."НАЛОГ,%" < any (select "НАЛОГ,%"
                                    from "СОТРУДНИК"));
```
| ФАМИЛИЯ |
| :--- |
| Махалина |
| Пивоваров |

d) запрос задания 7.с
```sql
select "НАЗВАНИЕ ОРГ.", "ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД, %"
from "МЕСТО РАБОТЫ"
where "ИДЕНТИФИКАТОР" in (select "МЕСТО РАБОТЫ"
                          from "РАБОТА"
                          where "СОТРУДНИК" = any (select distinct "СОТРУДНИК"
                                                   from "РАБОТА"
                                                   where "СОТРУДНИК" = 5)
                          group by "МЕСТО РАБОТЫ"
                          having count(*) > 1
)
```
| НАЗВАНИЕ ОРГ. | ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД, % |
| :--- | :--- |

№12 Используя операцию UNION получить адреса проживания сотрудников и места расположения организаций.

```sql
select "СОТРУДНИК"."АДРЕС"
from "СОТРУДНИК"
union
select "МЕСТО РАБОТЫ"."АДРЕС"
from "МЕСТО РАБОТЫ";
```
| АДРЕС |
| :--- |
| Сормовский |
| Приокский |
| Канавинский |
| Нижегородский |
| Советский |

№13 Используя операцию EXISTS ( NOT EXISTS ) реализовать нижеследующие запросы. 
    В случае, если для текущего состояния БД запрос будет выдавать пустое множество строк, 
    требуется указать какие добавления в БД необходимо провести.

a) найти сотрудников, работавших на должности доцента во всех организациях;
```sql
select distinct "ФАМИЛИЯ"
from "СОТРУДНИК"
where exists(
              select "РАБОТА"."СОТРУДНИК"
              from "РАБОТА",
                   "ДОЛЖНОСТЬ"
              where "ДОЛЖНОСТЬ"."НАЗВАНИЕ" != 'Доцент'
                and "РАБОТА"."МЕСТО РАБОТЫ" not in (1, 2, 3, 4, 5, 6))
```
| ФАМИЛИЯ |
| :--- |

b) найти места работы на которых работали все сотрудники из Приокского или Сормовского районов;
```sql
select "НАЗВАНИЕ ОРГ."
from "МЕСТО РАБОТЫ"
where exists(
              select "РАБОТА"."МЕСТО РАБОТЫ"
              from "РАБОТА",
                   "СОТРУДНИК"
              where "РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР"
                and "РАБОТА"."МЕСТО РАБОТЫ" = "МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР"
                and "СОТРУДНИК"."АДРЕС" in ('Сормовский', 'Приокский'));
```
| НАЗВАНИЕ ОРГ. |
| :--- |
| Университет |
| Сельхоз. академия |
| Институт механики |

c) определить должности на которых не работали сотрудники в организациях чужих районов;
```sql
select "НАЗВАНИЕ"
from "ДОЛЖНОСТЬ"
where exists(
        select "РАБОТА"."СОТРУДНИК"
        from "РАБОТА",
             "СОТРУДНИК",
             "МЕСТО РАБОТЫ"
        where "РАБОТА"."МЕСТО РАБОТЫ" = "МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР"
          and "РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР"
          and "МЕСТО РАБОТЫ"."АДРЕС" != "СОТРУДНИК"."АДРЕС"
    )
```
| НАЗВАНИЕ |
| :--- |
| Ассистент |
| Старший преподаватель |
| Доцент |
| Профессор |
| Мл. научный сотрудник |
| Ст. Научный сотрудник |
| Зав. лабораторией |

d) найти сотрудника и должность, в которой этот сотрудник проработал во всех организациях Нижегородского или Сормовского районов.
```sql

```

№14 Реализовать запросы с использованием аггрегатных функций:

a) найти число различных работников, трудившихся в должности ассистента до ноября;
```sql
select count(distinct "РАБОТА"."СОТРУДНИК")
from "РАБОТА", "ДОЛЖНОСТЬ"
where "РАБОТА"."ДОЛЖНОСТЬ" = 1 and "РАБОТА"."ДАТА" != 'Ноябрь';
```
| count |
| :--- |
| 3 |

b) определить среднюю величину отчислений для тех организаций, где трудились сотрудники с налогом менее 15%;
```sql
select sum("ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД") / count("ОТЧИСЛЕНИЕ В ПЕНСИОННЫЙ ФОНД") as "СР.ВЕЛИЧИНА ОТЧИСЛЕНИЙ"
from "РАБОТА", "СОТРУДНИК"
where "РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР" and "НАЛОГ,%" < 15;
```
| СР.ВЕЛИЧИНА ОТЧИСЛЕНИЙ |
| :--- |
| 40406 |

c) найти число сотрудников, работавших до марта в университете;
```sql
select count("РАБОТА"."МЕСТО РАБОТЫ")
from "РАБОТА"
where "МЕСТО РАБОТЫ" = 1 and "ДАТА" not in('Март', 'Апрель', 'Май','Июнь', 'Июль', 'Август')
```
| count |
| :--- |
| 1 |

d) какие работники получали плату выше средней
```sql
select distinct "ФАМИЛИЯ"
from "СОТРУДНИК",
     "РАБОТА"
where "РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР"
  and "ПЛАТАРУБ" > (select sum("ПЛАТАРУБ") / count("ПЛАТАРУБ") as "СР ЗП"
                    from "РАБОТА"
)
```
| ФАМИЛИЯ |
| :--- |
| Махалина |
| Щанников |
| Пивоваров |

№15 Используя средства группировки реализовать следующие запросы:

a) найти должности, на которых работало более трех человек;
```sql
select "ДОЛЖНОСТЬ"."НАЗВАНИЕ"
from "ДОЛЖНОСТЬ",
     "РАБОТА"
where "РАБОТА"."ДОЛЖНОСТЬ" = "ДОЛЖНОСТЬ"."ИДЕНТИФИКАТОР"
group by "ДОЛЖНОСТЬ"."НАЗВАНИЕ"
having count(*) > 3;
```
| НАЗВАНИЕ |
| :--- |
| Старший преподаватель |

b) найти для каждого сотрудника максимальную получаемую плату;
```sql
select distinct "ФАМИЛИЯ", sum("ПЛАТАРУБ")
from "РАБОТА",
     "СОТРУДНИК"
where "РАБОТА"."СОТРУДНИК" = "СОТРУДНИК"."ИДЕНТИФИКАТОР"
group by "СОТРУДНИК"."ФАМИЛИЯ"
```
| ФАМИЛИЯ | sum |
| :--- | :--- |
| Воробьев | 1275000 |
| Алексанов | 1147500 |
| Пивоваров | 4950000 |
| Махалина | 7290000 |
| Щанников | 2762500 |

c) какие организации за месяц тратили на зарплату более 1000000;
```sql
select "НАЗВАНИЕ ОРГ."
from "МЕСТО РАБОТЫ", "РАБОТА"
where "РАБОТА"."МЕСТО РАБОТЫ" = "МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР"
group by "НАЗВАНИЕ ОРГ."
having sum("ПЛАТАРУБ") > 1000000;
```
| НАЗВАНИЕ ОРГ. |
| :--- |
| Институт механики |

d) получить для каждой организации из Нижегородского или Сормовского района среднее число часов, которое нарабатывали сотрудники.
```sql
select "НАЗВАНИЕ ОРГ.", sum("КОЛ-ВО ЧАСОВ")
from "МЕСТО РАБОТЫ",
     "РАБОТА"
where "РАБОТА"."МЕСТО РАБОТЫ" = "МЕСТО РАБОТЫ"."ИДЕНТИФИКАТОР"
  and "МЕСТО РАБОТЫ"."АДРЕС" in ('Сормовский', 'Нижегородский')
group by "НАЗВАНИЕ ОРГ.";
```
| НАЗВАНИЕ ОРГ. | sum |
| :--- | :--- |
| Академия бизнеса | 51 |
| НИИ ПМК | 10 |
| Технический Унивреситет | 30 |







